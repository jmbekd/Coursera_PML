---
title: "Coursera PML Assignment"
author: "John Montgomery-Brown"
date: "Tuesday, October 14, 2014"
output: html_document
---

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
dir <- "./data/"
URL <- "https://d396qusza40orc.cloudfront.net/predmachlearn/"
names <- c("pml-training.csv", "pml-testing.csv")

if (!("pml_data.rda" %in% list.files(dir))) {
  if (!file.exists(dir)) dir.create(dir)
  dateDownloaded <- sapply(names, function(x) {
    download.file(paste0(URL, x), destfile = paste0(dir, x), mode = "wb")
    date()
    } )
  
  if (!require("data.table")) install.packages("data.table", repos = "http://cran.r-project.org")
  library(data.table)
  
  train <- fread(paste0(dir, "pml-training.csv"))
  test <- fread(paste0(dir, "pml-testing.csv"))
  
  save(train, test, dateDownloaded, file = paste0(dir, "pml_data.rda"))
  } else {
    load(paste0(dir, "pml_data.rda"))
  }


```

You can also embed plots, for example:

```{r}

# replace all #DIV/0! by Inf (they are the result of dividing by 0 (typically due to the standard deviation being 0))
# 4 sensors, 3 Euler angles (roll, pitch, yaw), eight features (original value, mean, variance, standard deviation, max, min, amplitude, kurtosis, skewness) = Total 108 features
# Also, 4 sensors, accelerometer, gyroscope, and magnetometer readings (x, y, z components for each and a total acceleration and variance of the acceleration) = 44 additional features, also have variance of acceleration
# eight informational columns
#38 features for the four sensors + 8 information columns; 
#skewness_roll_belt.1 is actually skewness_pitch_belt (if it is not, then skewness_roll_belt is skewness_pitch_belt)


# if not a new_window, no summary statistics calculated


preprocess <- function(DT) {
  DT_sub <- DT[new_window == "yes"][, 8:ncol(DT), with = FALSE]
  for (j in seq_along(DT_sub)) 
    set(DT_sub, which(DT_sub[[j]] == "#DIV/0!"), j, value = "Inf")
  for (cols in seq_len(ncol(DT_sub) - 1))
    set(DT_sub, j = cols, value = as.numeric(DT_sub[[cols]]))
  DT_sub
}

train_pp <- preprocess(train)

```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
